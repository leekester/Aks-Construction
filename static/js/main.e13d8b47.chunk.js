(this["webpackJsonpaks-deploy-guide2"]=this["webpackJsonpaks-deploy-guide2"]||[]).push([[0],{119:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t),n.d(t,"appInsights",(function(){return de})),n.d(t,"ConfigContext",(function(){return ue}));var a=n(0),r=n.n(a),s=n(53),i=n.n(s),o=(n(119),n(21)),c=n(4),l=n(31),d=n(200),u=n(208),p=n(210),b=n(194),g=n(60),h=n(203),j=n(193),m=n(204),y=n(199),x=n(97),f=n(3),v=n(202),k=n(10),O=n(197),w=n(205),A=n(206),P=n(207),S=n(14),C=n(216),I=n(191),z=n(1),N=Object(f.C)({fontSize:80,margin:"0 80px"}),G=function(e){var t=e.sections,n=e.selectedValues,a=e.updateSelected;return t.map((function(e){return[Object(z.jsx)(m.a,{styles:{root:{marginTop:"15px !important",marginBottom:"15px"}},children:Object(z.jsx)("b",{children:e.sectionTitle})},"sep".concat(e.key)),Object(z.jsx)("div",{children:e.sectionWarning&&Object(z.jsx)(v.a,{styles:{root:{marginBottom:"15px",fontSize:"15px"}},messageBarType:k.a.severeWarning,children:e.sectionWarning},"messg".concat(e.key))},"warn".concat(e.key)),Object(z.jsx)(d.a,{horizontal:!0,tokens:{childrenGap:15},children:e.cards.map((function(t,r){return Object(z.jsxs)(O.a,{onClick:function(){return a(e.key,t.key)},tokens:{childrenMargin:12},children:[Object(z.jsx)(w.a,{styles:{root:{padding:"8px 16px",position:"relative"}},children:Object(z.jsx)(A.a,{inputProps:{"data-testid":"portalnav-presets-".concat(e.key,"-").concat(t.key,"-Checkbox")},checked:n[e.key]===t.key,label:t.title,styles:{label:{fontWeight:n[e.key]===t.key?"500":"normal"}}})}),t.imageSrc&&Object(z.jsx)(P.a,{styles:{root:{backgroundColor:"white"}},imageSrc:t.imageSrc,height:150,imageFit:S.b.centerContain}),t.icon&&Object(z.jsx)(C.a,{styles:{root:{backgroundColor:"white",borderBottom:"0"}},previewImages:[{previewIconProps:{iconName:t.icon,className:N},height:100}]}),Object(z.jsx)("div",{style:{padding:"8px 16px"},children:Object(z.jsxs)(u.a,{children:[t.description.title,t.description.titleWarning&&Object(z.jsx)(v.a,{messageBarType:t.description.titleWarning.MessageBarType,children:Object(z.jsx)(u.a,{children:t.description.titleWarning.description})}),Object(z.jsx)(u.a,{variant:"smallPlus",children:Object(z.jsx)("ul",{style:{paddingInlineStart:"20px"},children:t.description.bulets.map((function(e,t){return Object(z.jsxs)("li",{children:[e.description,e.linksrc&&Object(z.jsxs)("span",{children:[" (",Object(z.jsx)("a",{target:"_nsg",href:e.linksrc,children:"docs"}),")"]})]},t)}))})})]})}),t.author&&Object(z.jsx)(I.a,{activity:t.author.status,people:[{name:t.author.name,initials:t.author.initials}]})]},t.key)}))},"stack".concat(e.key))]}))},_=n(37),T=n(195),D=n(196),K=n(17),E=n(61),M=n(198),R=(n(78),n(217));function W(e,t){return e.findIndex((function(e){return e.field===t}))>=0}function B(e,t){var n=e.findIndex((function(e){return e.field===t}));return n>=0?e[n].message:""}var L={root:{border:"1px solid",background:"#fcfcfc",margin:"10px 0",padding:"15px"}};function F(e){var t=e.deploycmd,n=e.testId,r=Object(a.useState)(!1),s=Object(l.a)(r,2),i=s[0],o=s[1];return[Object(z.jsxs)("div",{className:"codeHeader",children:[Object(z.jsx)("span",{className:"language",children:"Bash"}),Object(z.jsx)(R.a,{disabled:i,className:"action position-relative",iconProps:{iconName:i?"Completed":"Copy"},styles:{icon:{color:"#171717"}},text:"Copy",onClick:function(){navigator.clipboard.writeText(t),o(!0),setTimeout((function(){return o(!1)}),1e3)}})]},"code-header"),Object(z.jsx)("pre",{className:"has-inner-focus",children:Object(z.jsx)("code",{className:"lang-bash",children:Object(z.jsx)("span",{"data-testid":n||"none",children:t})})},"code-pre")]}var V={tokens:{childrenGap:20},styles:{root:{minWidth:380}}};function q(e){var t=e.tabValues,n=e.updateFn,s=e.invalidArray,i=(e.featureFlag,Object(a.useState)(!1)),o=Object(l.a)(i,2),c=o[0],p=o[1],b=t.net,g=t.addons,j=r.a.createRef();return Object(z.jsxs)(d.a,{tokens:{childrenGap:15},styles:L,children:[Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{required:!0,children:"Network Plugin"}),Object(z.jsx)(v.a,{children:'Typically, only use "kubenet" networking if you need to limit your non-routable IP usage on your network (use network calculator)'}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:b.networkPlugin,options:[{key:"kubenet",text:'Use "kubenet" basic networking, so your PODs DO NOT receive VNET IPs'},{key:"azure",text:'Use "CNI" for fastest container networking, but using more IPs'}],onChange:function(e,t){var a=t.key;return n("networkPlugin",a)}})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Deploy Azure firewall for your cluster egress (Custom VNet Only)"}),W(s,"afw")&&Object(z.jsx)(v.a,{messageBarType:k.a.error,children:B(s,"afw")}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px",marginTop:"10 !important"}},disabled:!1,errorMessage:B(s,"afw"),checked:b.afw,onChange:function(e,t){return n("afw",t)},label:"Implement Azure Firewall & UDR next hop"})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Uses a private IP address from your VNet to access your dependent Azure service, such as Azure KeyVault, Azure Container Registry etc"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px",marginTop:"0 !important"}},disabled:!1,checked:b.vnetprivateend,onChange:function(e,t){return n("vnetprivateend",t)},label:"Enable Private Link"})]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Use Azure Bastion to facilitate RDP/SSH public internet inbound access into your virtual network"}),Object(z.jsx)(A.a,{inputProps:{"data-testid":"network-bastion-Checkbox"},styles:{root:{marginLeft:"50px",marginTop:"0 !important"}},disabled:!1,checked:b.bastion,onChange:function(e,t){return n("bastion",t)},label:"Enable Azure Bastion"})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsx)(d.a.Item,{children:Object(z.jsxs)(d.a,{horizontal:!0,children:[Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Default or Custom VNET"}),Object(z.jsxs)("div",{ref:j,style:{marginTop:0},children:[Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:b.vnet_opt,onClick:function(){return p(!0)},onChange:function(e,t){var a=t.key;return n("vnet_opt",a)},options:[{key:"default",iconProps:{iconName:"CubeShape"},text:"Default Networking"},{key:"custom",iconProps:{iconName:"CityNext"},text:"Custom Networking"},{key:"byo",disabled:!1,iconProps:{iconName:"WebAppBuilderFragment"},text:"BYO VNET (TBC)"}]}),W(s,"vnet_opt")&&Object(z.jsx)(v.a,{messageBarType:k.a.error,children:B(s,"vnet_opt")})]})]}),Object(z.jsxs)(d.a.Item,{children:[c&&"default"===b.vnet_opt&&Object(z.jsxs)(D.a,{className:"ms-CalloutExample-callout",target:j,directionalHint:K.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return p(!1)},children:[Object(z.jsx)(v.a,{messageBarType:k.a.info,children:"Default - Fully Managed Networking"}),Object(z.jsxs)("div",{style:{padding:"10px",maxWidth:"450px"},children:[Object(z.jsxs)(u.a,{children:["Select this option if you ",Object(z.jsx)(u.a,{style:{fontWeight:"bold"},children:" don't"})," require any custom IP settings, so you are not peering with other VNETs or On-Premises networks This is the simplest AKS deployment to operate, it provides a ",Object(z.jsx)(u.a,{style:{fontWeight:"bold"},children:" managed"})," network setup, including:"]}),Object(z.jsxs)("ul",{children:[Object(z.jsx)("li",{children:"New Dedicated VNET with private IP range for your agents nodes"}),Object(z.jsx)("li",{children:"Container Networking (default: CNI)"}),Object(z.jsx)("li",{children:"Standard LoadBalancer for kubernetes services with outbound rule for internet access"})]})]})]}),c&&"custom"===b.vnet_opt&&Object(z.jsxs)(D.a,{className:"ms-CalloutExample-callout",target:j,directionalHint:K.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return p(!1)},children:[Object(z.jsx)(v.a,{messageBarType:k.a.warning,children:"Custom Networking - Advanced Setup"}),Object(z.jsx)("div",{style:{padding:"10px",maxWidth:"500px"},children:Object(z.jsxs)(u.a,{children:["Select this option if you will you would like the helper to create a new VNET with specific ranges, use this option if you need to:",Object(z.jsxs)("ul",{children:[Object(z.jsx)("li",{children:"Connect your AKS network with another networks"}),Object(z.jsx)("li",{children:"You will be VNET peering or using an ExpressRoute or VPN Gateway"})]})]})})]}),c&&"byo"===b.vnet_opt&&Object(z.jsxs)(D.a,{className:"ms-CalloutExample-callout",target:j,directionalHint:K.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return p(!1)},children:[Object(z.jsx)(v.a,{messageBarType:k.a.warning,children:"Bring your own Networking - Advanced Setup"}),Object(z.jsxs)("div",{style:{padding:"10px",maxWidth:"500px"},children:[Object(z.jsx)(u.a,{children:"Select this option if you will be deploying AKS into an existing network configuration, for example."}),Object(z.jsxs)("ul",{children:[Object(z.jsxs)("li",{children:["If you are implementing the Secure Baseline Architecture ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks",children:"here"}),Object(z.jsx)(E.a,{imageFit:S.b.CenterContain,width:"100%",src:"./secure-baseline-architecture.svg"})]}),Object(z.jsx)("li",{children:"If you will deploy AKS into a pre-existing VNET, managed by a networking team"})]})]})]})]})]})}),"custom"===b.vnet_opt?Object(z.jsx)($,{addons:g,net:b,updateFn:n}):"byo"===b.vnet_opt&&Object(z.jsx)(Z,{addons:g,net:b,updateFn:n,invalidArray:s})]})}function U(e){var t=e.net,n=e.updateFn;return Object(z.jsxs)(d.a,Object(c.a)(Object(c.a)({},V),{},{children:[Object(z.jsx)(_.a,{children:"Kubernetes Networking Configuration"}),Object(z.jsx)(d.a.Item,{styles:{root:{width:"380px"}},align:"start",children:Object(z.jsx)(M.a,{prefix:"Cidr",label:"POD Network",disabled:"kubenet"!==t.networkPlugin,onChange:function(e,t){return n("podCidr",t)},value:"kubenet"===t.networkPlugin?t.podCidr:"Using CNI, POD IPs from subnet"})}),Object(z.jsxs)(d.a.Item,{styles:{root:{width:"380px"}},align:"start",children:[Object(z.jsx)(M.a,{prefix:"Cidr",label:"Service Network",onChange:function(e,t){return n("serviceCidr",t)},value:t.serviceCidr}),Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["Address space that isn't in use elsewhere in your network environment ",Object(z.jsx)("a",{target:"_target",href:"https://docs.microsoft.com/en-us/azure/aks/configure-kubenet#create-an-aks-cluster-in-the-virtual-network",children:"docs"})]})]}),Object(z.jsxs)(d.a.Item,{styles:{root:{width:"380px"}},align:"start",children:[Object(z.jsx)(M.a,{prefix:"IP",label:"Service Network",onChange:function(e,t){return n("dnsServiceIP",t)},value:t.dnsServiceIP}),Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["Ensure its an address within the Service CIDR above ",Object(z.jsx)("a",{target:"_target",href:"https://docs.microsoft.com/en-us/azure/aks/configure-kubenet#create-an-aks-cluster-in-the-virtual-network",children:"docs"})]})]})]}))}function Z(e){var t=e.net,n=e.addons,a=e.updateFn,r=e.invalidArray;return Object(z.jsxs)(d.a,{styles:L,children:[Object(z.jsx)(_.a,{children:"Bring your Own VNET and Subnets"}),Object(z.jsxs)(v.a,{children:["Get your user subnet by running ",Object(z.jsxs)(_.a,{children:["az network vnet subnet show --vnet-name `","<net name>","` -g `","<vnet rg>","` -n `","<subnet name>",'` --query "id"']})]}),Object(z.jsx)(M.a,{value:t.byoAKSSubnetId,onChange:function(e,t){return a("byoAKSSubnetId",t)},errorMessage:B(r,"byoAKSSubnetId"),required:!0,placeholder:"Resource Id",label:Object(z.jsx)(u.a,{style:{fontWeight:600},children:"Enter your existing AKS Nodes subnet ResourceId"})}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsx)(M.a,{disabled:"appgw"!==n.ingress,value:t.byoAGWSubnetId,onChange:function(e,t){return a("byoAGWSubnetId",t)},errorMessage:B(r,"byoAGWSubnetId"),required:!0,placeholder:"Resource Id",label:Object(z.jsx)(u.a,{style:{fontWeight:600},children:"Enter your existing Application Gateway subnet ResourceId"})}),Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["Ensure your Application Gateway subnet meets these requirements ",Object(z.jsx)(h.a,{href:"https://docs.microsoft.com/en-us/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",children:"here"})]}),Object(z.jsx)(m.a,{}),Object(z.jsx)(U,{net:t,updateFn:a})]})}function $(e){var t=e.net,n=e.addons,a=e.updateFn;return Object(z.jsxs)(d.a,{styles:L,children:[Object(z.jsx)(_.a,{children:"Custom Network VNET & Kubernetes Network Configuration"}),Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:50},styles:{root:{width:650}},children:[Object(z.jsxs)(d.a,Object(c.a)(Object(c.a)({},V),{},{children:[Object(z.jsx)(d.a.Item,{align:"start",children:Object(z.jsx)(M.a,{prefix:"Cidr",label:"VNET Address space",onChange:function(e,t){return a("vnetAddressPrefix",t)},value:t.vnetAddressPrefix})}),Object(z.jsx)(d.a.Item,{style:{marginLeft:"20px"},children:Object(z.jsx)(M.a,{prefix:"Cidr",label:"AKS Nodes subnet",onChange:function(e,t){return a("vnetAksSubnetAddressPrefix",t)},value:t.vnetAksSubnetAddressPrefix})}),Object(z.jsx)(d.a.Item,{style:{marginLeft:"20px"},children:Object(z.jsx)(M.a,{prefix:"Cidr",disabled:!t.afw,label:"Azure Firewall subnet",onChange:function(e,t){return a("vnetFirewallSubnetAddressPrefix",t)},value:t.afw?t.vnetFirewallSubnetAddressPrefix:"No Firewall requested"})}),Object(z.jsxs)(d.a.Item,{style:{marginLeft:"20px"},children:[Object(z.jsx)(M.a,{prefix:"Cidr",disabled:"appgw"!==n.ingress,label:"Application Gateway subnet",onChange:function(e,t){return a("vnetAppGatewaySubnetAddressPrefix",t)},value:"appgw"===n.ingress?t.vnetAppGatewaySubnetAddressPrefix:"No Application Gateway requested"}),Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["Ensure your Application Gateway subnet meets ",Object(z.jsx)(h.a,{href:"https://docs.microsoft.com/en-us/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",children:"these"})," requirements"]})]}),Object(z.jsx)(d.a.Item,{style:{marginLeft:"20px"},children:Object(z.jsx)(M.a,{prefix:"Cidr",disabled:!t.vnetprivateend||"none"===n.registry||!n.acrPrivatePool,label:"ACR Private Agent Pool subnet",onChange:function(e,t){return a("acrAgentPoolSubnetAddressPrefix",t)},value:t.vnetprivateend&&"none"!==n.registry&&n.acrPrivatePool?t.acrAgentPoolSubnetAddressPrefix:"No Agent Pool requested"})}),Object(z.jsx)(d.a.Item,{style:{marginLeft:"20px"},children:Object(z.jsx)(M.a,{prefix:"Cidr",disabled:!t.bastion,label:"Azure Bastion subnet",onChange:function(e,t){return a("bastionSubnetAddressPrefix",t)},value:t.bastion?t.bastionSubnetAddressPrefix:"No bastion subnet requested"})}),Object(z.jsx)(d.a.Item,{style:{marginLeft:"20px"},children:Object(z.jsx)(M.a,{prefix:"Cidr",disabled:!t.vnetprivateend,label:"Private Endpoint subnet",onChange:function(e,t){return a("privateLinkSubnetAddressPrefix",t)},value:t.vnetprivateend?t.privateLinkSubnetAddressPrefix:"No Private Endpoints requested"})})]})),Object(z.jsx)(U,{net:t,updateFn:a})]})]})}var H=n(190),Y=n(201),J=function(e){var t=e.tabValues,n=e.updateFn,a=e.invalidArray,r=t.addons,s=t.net;return Object(z.jsxs)(d.a,{tokens:{childrenGap:15},styles:L,children:[Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{children:"Cluster Monitoring requirements"}),Object(z.jsx)(v.a,{children:"Observing your clusters health is critical to smooth operations, select the managed Azure Monitor for Containers option, or the open source CNCF Prometheus/Grafana solution"}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.monitor,options:[{key:"none",text:"None"},{key:"aci",text:"Azure Monitor for Containers (logs and metrics)"},{key:"oss",text:"Prometheus / Grafana Helm Chart (metrics only)"}],onChange:function(e,t){var a=t.key;return n("monitor",a)}})]}),"aci"===r.monitor&&Object(z.jsxs)(d.a.Item,{align:"center",styles:{root:{maxWidth:"700px"}},children:[Object(z.jsx)(H.a,{label:"Log and Metrics Data Retention (Days)",onChange:function(e,t){var a=t.key;return n("retentionInDays",a)},selectedKey:r.retentionInDays,options:[{key:30,text:"30 Days"},{key:60,text:"60 Days"},{key:90,text:"90 Days"},{key:120,text:"120 Days"},{key:180,text:"180 Days"},{key:270,text:"270 Days"},{key:365,text:"365 Days"}]}),Object(z.jsx)(A.a,{styles:{root:{marginTop:"10px"}},checked:r.createAksMetricAlerts,onChange:function(e,t){return n("createAksMetricAlerts",t)},label:Object(z.jsxs)(u.a,{children:["Create recommended metric alerts, enable you to monitor your system resource when it's running on peak capacity or hitting failure rates (",Object(z.jsx)(h.a,{target:"_target",href:"https://azure.microsoft.com/en-us/updates/ci-recommended-alerts/",children:"docs"}),") "]})})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{children:"Azure Policy, to manage and report on the compliance state of your Kubernetes clusters"}),Object(z.jsx)(v.a,{children:"Azure Policy extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner."}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.azurepolicy,options:[{key:"none",text:"No restrictions, users can deploy any kubernetes workloads"},{key:"audit",text:"AUDIT compliance with the set of cluster pod security baseline standards for Linux-based workloads"},{key:"deny",text:"BLOCK and non-compliant Linux-based workloads with the set of cluster pod security baseline standards"}],onChange:function(e,t){var a=t.key;return n("azurepolicy",a)}}),"none"!==r.azurepolicy&&Object(z.jsxs)(v.a,{messageBarType:k.a.success,styles:{root:{marginTop:"20px",marginLeft:"100px",width:"700px"}},children:["The template will automatically assign and ",Object(z.jsx)("b",{children:r.azurepolicy})," the following ",Object(z.jsx)(h.a,{target:"_target",href:"https://github.com/Azure/azure-policy/blob/master/built-in-policies/policySetDefinitions/Kubernetes/Kubernetes_PSPBaselineStandard.json",children:"Policies"}),":",Object(z.jsxs)("ul",{children:[Object(z.jsx)("li",{children:"Do not allow privileged containers in Kubernetes cluster"}),Object(z.jsx)("li",{children:"Kubernetes cluster pods should only use approved host network and port range"}),Object(z.jsx)("li",{children:"Kubernetes cluster containers should not share host process ID or host IPC namespace"}),Object(z.jsx)("li",{children:"Kubernetes cluster containers should only use allowed capabilities"}),Object(z.jsx)("li",{children:"Kubernetes cluster pod hostPath volumes should only use allowed host paths"})]})]})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{children:"Cluster East-West traffic restrictions (Network Policies)"}),Object(z.jsx)(v.a,{children:"Control which components can communicate with each other. The principle of least privilege should be applied to how traffic can flow between pods in an Azure Kubernetes Service (AKS) cluster"}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.networkPolicy,options:[{"data-testid":"addons-netpolicy-none",key:"none",text:"No restrictions, all PODs can access each other"},{"data-testid":"addons-netpolicy-calico",key:"calico",text:'Use Network Policy addon with Calico to implemented intra-cluster traffic restrictions (driven from "NetworkPolicy" objects)'},{"data-testid":"addons-netpolicy-azure",key:"azure",text:'Use Network Policy addon with Azure provider to implemented intra-cluster traffic restrictions (driven from "NetworkPolicy" objects)'}],onChange:function(e,t){var a=t.key;return n("networkPolicy",a)}})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{required:!0,children:"Securely Expose your applications via Layer 7 HTTP(S) proxies (Ingress Controller)"}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.ingress,options:[{key:"none",text:"No, I do not need a Layer7 proxy, or I will configure my own solution"},{key:"appgw",text:"Yes, I want a Azure Managed Application Gateway with WAF protection"},{key:"contour",text:"Yes, deploy contour in the cluster to expose my apps to the internet (https://projectcontour.io/)"},{key:"nginx",text:"Yes, deploy nginx in the cluster to expose my apps to the internet (nginx ingress controller)"}],onChange:function(e,t){var a=t.key;return n("ingress",a)}}),W(a,"ingress")&&Object(z.jsx)(v.a,{styles:{root:{marginTop:"20px",marginLeft:"100px",width:"700px"}},messageBarType:k.a.error,children:B(a,"ingress")})]}),Object(z.jsx)(d.a.Item,{align:"center",styles:{root:{maxWidth:"700px",display:"none"===r.ingress?"none":"block"}},children:Object(z.jsxs)(d.a,{tokens:{childrenGap:15},children:["nginx"===r.ingress&&!1,"none"!==r.ingress&&!1,"nginx"===r.ingress&&Object(z.jsx)(A.a,{checked:r.ingressEveryNode,onChange:function(e,t){return n("ingressEveryNode",t)},label:Object(z.jsx)(u.a,{children:"Run nginx on every node (deploy as Daemonset)"})}),"appgw"===r.ingress&&("default"===s.vnet_opt?Object(z.jsx)(v.a,{messageBarType:k.a.warning,children:"Using default networking, so addon will provision default Application Gateway instance, for more options, select custom networking in the network tab"}):Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(v.a,{messageBarType:k.a.warning,children:"Custom or BYO networking is requested, so template will provision a new Application Gateway"}),Object(z.jsx)(A.a,{inputProps:{"data-testid":"addons-ingress-appgwKVIntegration-Checkbox"},checked:r.appgwKVIntegration,onChange:function(e,t){return n("appgwKVIntegration",t)},label:Object(z.jsxs)(u.a,{children:["Enable KeyVault Integration for TLS Certificates (",Object(z.jsx)(h.a,{target:"_ar1",href:"https://docs.microsoft.com/en-us/azure/application-gateway/key-vault-certs",children:"docs"}),") "]})}),W(a,"appgwKVIntegration")&&Object(z.jsx)(v.a,{styles:{root:{marginTop:"0px !important"}},messageBarType:k.a.error,children:B(a,"appgwKVIntegration")}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsxs)(_.a,{style:{marginBottom:"0px"},children:["Application Gateway Type (",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/en-us/azure/web-application-firewall/ag/ag-overview",children:"docs"}),")"]}),Object(z.jsx)(T.a,{selectedKey:r.appGWsku,options:[{key:"Standard_v2",text:"Standard_v2: Standard Application Gateway"},{key:"WAF_v2",text:"WAF_v2: Web Application Firewall (WAF) on Application Gateway"}],onChange:function(e,t){var a=t.key;return n("appGWsku",a)}})]}),"WAF_v2"===r.appGWsku&&Object(z.jsxs)(d.a.Item,{style:{marginLeft:"20px"},children:[Object(z.jsx)(A.a,{checked:r.appGWenableFirewall,onChange:function(e,t){return n("appGWenableFirewall",t)},label:Object(z.jsx)(u.a,{children:"Enable Firewall: Provides centralized protection of your web applications from common exploits and vulnerabilities"})}),r.appGWenableFirewall&&Object(z.jsxs)(d.a.Item,{style:{marginLeft:"25px"},children:[Object(z.jsx)(_.a,{style:{marginBottom:"0px",marginTop:"5px"},children:"WAF mode"}),Object(z.jsx)(T.a,{style:{marginBottom:"0px",marginTop:"0px"},selectedKey:r.appGwFirewallMode,options:[{key:"Prevention",text:"Prevention:   Blocks intrusions and attacks that the rules detect"},{key:"Detection",text:"Detection:   Monitors and logs all threat alerts."}],onChange:function(e,t){var a=t.key;return n("appGwFirewallMode",a)}})]})]}),Object(z.jsx)(_.a,{style:{marginBottom:"0px"},children:"Capacity"}),Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:150},styles:{root:{marginTop:"0px !important"}},children:[Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(T.a,{selectedKey:r.appGWautoscale,onChange:function(e,t){var a=t.key;return n("appGWautoscale",a)},options:[{key:!1,text:"Manual"},{key:!0,text:"Autoscale"}]})}),Object(z.jsx)(d.a.Item,{children:Object(z.jsxs)(d.a,{tokens:{childrenGap:0},styles:{root:{width:450}},children:[Object(z.jsx)(Y.a,{label:"".concat(r.appGWautoscale?"Minimum instance count":"Instance count"),min:r.appGWautoscale?0:1,max:125,step:1,defaultValue:r.appGWcount,showValue:!0,onChange:function(e){return n("appGWcount",e)}}),r.appGWautoscale&&Object(z.jsx)(Y.a,{label:"Maximum instance count",min:2,max:125,step:1,defaultValue:r.appGWmaxCount,showValue:!0,onChange:function(e){return n("appGWmaxCount",e)},snapToStep:!0})]})})]}),Object(z.jsx)(A.a,{checked:r.appgw_privateIp,onChange:function(e,t){return n("appgw_privateIp",t)},label:Object(z.jsxs)(u.a,{children:["Use a Private Frontend IP for Ingress (",Object(z.jsx)(h.a,{target:"_ar1",href:"https://docs.microsoft.com/en-us/azure/application-gateway/ingress-controller-private-ip",children:"docs"}),")"]})}),r.appgw_privateIp&&Object(z.jsx)(M.a,{value:r.appgw_privateIpAddress,onChange:function(e,t){return n("appgw_privateIpAddress",t)},errorMessage:B(a,"appgw_privateIpAddress"),required:!0,placeholder:"Resource Id",label:Object(z.jsxs)(u.a,{style:{fontWeight:600},children:["Enter Private IP address from the AppGW CIDR subnet range (",Object(z.jsx)("b",{children:"custom"===s.vnet_opt?s.vnetAppGatewaySubnetAddressPrefix:"examine BYO subnet range"}),")"]})})]})),("contour"===r.ingress||"nginx"===r.ingress||"appgw"===r.ingress)&&Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(A.a,{inputProps:{"data-testid":"addons-dns"},checked:r.dns,onChange:function(e,t){return n("dns",t)},label:Object(z.jsxs)(u.a,{children:["Create FQDN URLs for your applications using",Object(z.jsxs)(h.a,{target:"_t1",href:"https://github.com/kubernetes-sigs/external-dns",children:[" ",Object(z.jsx)("b",{children:"external-dns"})," "]}),"(requires Azure ",Object(z.jsxs)(h.a,{href:"https://docs.microsoft.com/en-us/azure/dns/dns-getstarted-portal#create-a-dns-zone",target:"_t1",children:[" ",Object(z.jsx)("b",{children:"Public"})," "]})," or ",Object(z.jsxs)(h.a,{href:"https://docs.microsoft.com/en-us/azure/dns/private-dns-getstarted-portal",target:"_t1",children:[" ",Object(z.jsx)("b",{children:"Private"})," "]})," DNS Zone)"]})}),r.dns&&Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["If using a Public DNS Zone, you need to own a custom domain, you can easily purchase a custom domain through Azure ",Object(z.jsxs)(h.a,{target:"_t1",href:"https://docs.microsoft.com/en-us/azure/app-service/manage-custom-dns-buy-domain",children:[" ",Object(z.jsx)("b",{children:"details here"})]})]}),Object(z.jsx)(M.a,{value:r.dnsZoneId,onChange:function(e,t){return n("dnsZoneId",t)},errorMessage:B(a,"dnsZoneId"),required:!0,placeholder:"Resource Id",label:Object(z.jsxs)(u.a,{style:{fontWeight:600},children:["Enter your Public or Private Azure DNS Zone ResourceId ",Object(z.jsx)(h.a,{target:"_t2",href:"https://ms.portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones",children:"find it here"})]})}),Object(z.jsx)(A.a,{inputProps:{"data-testid":"addons-certMan"},disabled:W(a,"dnsZoneId"),checked:r.certMan,onChange:function(e,t){return n("certMan",t)},label:"Automatically Issue Certificates for HTTPS using cert-manager (with Lets Encrypt - requires email"}),r.certMan&&Object(z.jsx)(M.a,{value:r.certEmail,onChange:function(e,t){return n("certEmail",t)},errorMessage:B(a,"certEmail")?"Enter valid email":"",label:"Enter mail address for certificate notification:",required:!0})]})]})]})}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{required:!0,children:"Do you require a secure private container registry to store my application images"}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.registry,options:[{key:"none",text:"No, my application images will be on DockerHub or another registry"},{key:"Basic",text:'Yes, setup Azure Container Registry "Basic" tier & authorise aks to pull images'},{key:"Standard",text:'Yes, setup Azure Container Registry "Standard" tier (minimum recommended for production)'},{key:"Premium",text:'Yes, setup Azure Container Registry "Premium" tier (required for Private Link)'}],onChange:function(e,t){var a=t.key;return n("registry",a)}}),W(a,"registry")&&Object(z.jsx)(v.a,{styles:{root:{marginLeft:"50px",width:"700px"}},messageBarType:k.a.error,children:B(a,"registry")})]}),Object(z.jsxs)(d.a.Item,{align:"center",styles:{root:{width:"700px"}},children:[Object(z.jsx)(A.a,{disabled:"none"===r.registry||!s.vnetprivateend,checked:r.acrPrivatePool,onChange:function(e,t){return n("acrPrivatePool",t)},label:Object(z.jsxs)(u.a,{children:["Create ACR Private Agent Pool (private link only) (preview limited regions ",Object(z.jsx)("a",{target:"_new",href:"https://docs.microsoft.com/azure/container-registry/tasks-agent-pools",children:"docs"}),")"]})}),Object(z.jsxs)(d.a,{horizontal:!0,styles:{root:{marginLeft:"50px"}},children:[Object(z.jsx)(M.a,{disabled:!0,label:"Agent Pool",defaultValue:"S1"}),Object(z.jsx)(M.a,{disabled:!0,label:"O/S",defaultValue:"Linux"}),Object(z.jsx)(M.a,{disabled:!0,label:"Agent Count",defaultValue:"1"})]})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsxs)(_.a,{required:!0,children:["CSI Secrets : Store Kubernetes Secrets in Azure KeyVault, using AKS Managed Identity (**Preview) (",Object(z.jsx)("a",{target:"_new",href:"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver",children:"docs"}),")"]}),Object(z.jsx)(T.a,{styles:{root:{marginLeft:"50px"}},selectedKey:r.csisecret,options:[{key:"none",text:"No, I am happy to use the default Kubernetes secret storage, or I will configure my own solution"},{key:"akvExist",text:"Yes, store secrets in an existing KeyVault & enable Secrets Store CSI Driver"},{key:"akvNew",text:"Yes, provision a new Azure KeyVault & enable Secrets Store CSI Driver"}],onChange:function(e,t){var a=t.key;return n("csisecret",a)}})]}),Object(z.jsx)(d.a.Item,{align:"center",styles:{root:{minWidth:"700px",display:"none"===r.csisecret?"none":"block"}},children:Object(z.jsx)(d.a,{tokens:{childrenGap:15},children:"akvExist"===r.csisecret&&Object(z.jsx)(M.a,{value:r.kvId,onChange:function(e,t){return n("kvId",t)},errorMessage:B(a,"kvId"),required:!0,placeholder:"Resource Id",label:Object(z.jsx)(u.a,{style:{fontWeight:600},children:"Enter your Azure Key Vault Resource Id"})})})})]})},Q=n(186),X=Object(f.C)({display:"flex",alignItems:"baseline"}),ee=[{key:"b",text:"Burstable (dev/test)",itemType:Q.a.Header},{key:"Standard_B2s",text:"2 vCPU,  4 GiB RAM,   8GiB SSD, 40%\t-> 200% CPU",eph:!0},{key:"dv2",text:"General purpose V2",itemType:Q.a.Header},{key:"default",text:"2 vCPU,  7 GiB RAM,  14GiB SSD,  86 GiB cache (8000 IOPS)",eph:!1},{key:"Standard_DS3_v2",text:"4 vCPU, 14 GiB RAM,  28GiB SSD, 172 GiB cache (16000 IOPS)",eph:!0},{key:"dv4",text:"General purpose V4",itemType:Q.a.Header},{key:"Standard_D2ds_v4",text:"2 vCPU,  8 GiB RAM,  75GiB SSD,               (19000 IOPS)",eph:!1},{key:"Standard_D4ds_v4",text:"4 vCPU, 16 GiB RAM, 150GiB SSD, 100 GiB cache (38500 IOPS)",eph:!1},{key:"Standard_D8ds_v4",text:"8 vCPU, 32 GiB RAM, 300GiB SSD,               (77000 IOPS)",eph:!0},{key:"fv2",text:"Compute optimized",itemType:Q.a.Header},{key:"Standard_F2s_v2",text:"2 vCPU,  4 GiB RAM,  16GiB SSD,               (3200 IOPS)",eph:!1}],te=function(e){var t=e.tabValues,n=e.updateFn,a=e.invalidArray,r=t.cluster;return Object(z.jsxs)(d.a,{tokens:{childrenGap:15},styles:L,children:[Object(z.jsx)(_.a,{style:{marginBottom:"10px"},children:"Cluster Performance & Scale Requirements"}),Object(z.jsxs)(d.a,{vertical:!0,tokens:{childrenGap:15},style:{marginTop:0,marginLeft:"50px"},children:[Object(z.jsx)(d.a,{horizontal:!0,tokens:{childrenGap:55},children:Object(z.jsxs)(d.a.Item,{children:[Object(z.jsxs)(_.a,{children:["Uptime SLA ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/uptime-sla",children:"docs"})]}),Object(z.jsx)(T.a,{selectedKey:r.AksPaidSkuForSLA,options:[{key:!1,text:"Free clusters with a service level objective (SLO) of 99.5%"},{key:!0,text:"Uptime SLA guarantees 99.95% availability of the Kubernetes API server endpoint for clusters that use Availability Zones"}],onChange:function(e,t){var a=t.key;return n("AksPaidSkuForSLA",a)}})]})}),Object(z.jsx)(d.a,{horizontal:!0,tokens:{childrenGap:55},children:Object(z.jsxs)(d.a.Item,{children:[Object(z.jsxs)(_.a,{children:["System Pool Type ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/use-system-pools#system-and-user-node-pools",children:"docs"})]}),Object(z.jsx)(T.a,{selectedKey:r.SystemPoolType,options:[{"data-testid":"cluster-systempool-none",key:"none",text:"No separate system pool: Use a single pool for System and User workloads"},{"data-testid":"cluster-systempool-Cost-Optimised",key:"Cost-Optimised",text:"Cost-Optimised: use low-cost Burstable VMs, with 1-3 node autoscale"},{"data-testid":"cluster-systempool-Standard",key:"Standard",text:"Standard: use standard 4-core VMs, with 2-3 node autoscale"}],onChange:function(e,t){var a=t.key;return n("SystemPoolType",a)}})]})}),Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:150},children:[Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Scale Type"}),Object(z.jsx)(T.a,{selectedKey:r.autoscale,onChange:function(e,t){var a=t.key;return n("autoscale",a)},options:[{key:!1,iconProps:{iconName:"FollowUser"},text:"Manual scale"},{key:!0,iconProps:{iconName:"ScaleVolume"},text:"Autoscale"}]})]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Scale Values"}),Object(z.jsxs)(d.a,{tokens:{childrenGap:0},styles:{root:{width:450}},children:[Object(z.jsx)(Y.a,{label:"Initial ".concat(r.autoscale?"(& Autoscaler Min nodes)":"nodes"),min:1,max:10,step:1,defaultValue:r.agentCount,showValue:!0,onChange:function(e){return n("agentCount",e)}}),r.autoscale&&Object(z.jsx)(Y.a,{label:"Autoscaler Max nodes",min:5,max:100,step:5,defaultValue:r.maxCount,showValue:!0,onChange:function(e){return n("maxCount",e)},snapToStep:!0})]})]})]}),Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:55},children:[Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Compute Type"}),Object(z.jsx)(T.a,{selectedKey:"gp",options:[{key:"gp",iconProps:{iconName:"Processing"},text:"General Purpose"},{key:"iops",iconProps:{iconName:"OfflineStorageSolid"},text:"IO Optimised",disabled:!0},{key:"gpu",iconProps:{iconName:"Game"},text:"GPU Workloads",disabled:!0}]})]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Node Size"}),Object(z.jsxs)(d.a,{tokens:{childrenGap:10},styles:{root:{width:450}},children:[Object(z.jsx)(H.a,{selectedKey:r.vmSize,onChange:function(e,t){var a=t.key;return n("vmSize",a)},placeholder:"Select VM Size",options:ee,styles:{dropdown:{width:"100%"}}}),W(a,"osDiskType")&&Object(z.jsx)(v.a,{messageBarType:k.a.error,children:B(a,"osDiskType")}),Object(z.jsx)(T.a,{onChange:function(e,t){var a=t.key;return n("osDiskType",a)},selectedKey:r.osDiskType,options:[{key:"Ephemeral",text:"Ephemeral (Requires Node with >137GiB of cache)"},{key:"Managed",text:"Persistent in Storage Account"}]}),"Managed"===r.osDiskType&&Object(z.jsx)(H.a,{label:"OS disk size",selectedKey:r.osDiskSizeGB,onChange:function(e,t){var a=t.key;return n("osDiskSizeGB",a)},placeholder:"Select OS Disk",options:[{key:"df",text:"Use the default for the VM size",itemType:Q.a.Header},{key:0,text:"default"},{key:"pd",text:"Premium SSD Managed Disks",itemType:Q.a.Header},{key:32,text:"32 GiB (120 IOPS)"},{key:64,text:"64 GiB (240 IOPS)"},{key:128,text:"128 GiB (500 IOPS)"}],styles:{dropdown:{width:"100%"}}})]})]})]})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsxs)(_.a,{required:!0,children:["Zone Support - AKS clusters deployed with multiple availability zones configured across a cluster provide a higher level of availability to protect against a hardware failure or a planned maintenance event. See ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/availability-zones#limitations-and-region-availability",children:"limits"})," before selecting"]}),Object(z.jsx)(T.a,{selectedKey:r.availabilityZones,styles:{root:{marginLeft:"50px"}},options:[{key:"no",text:"Deploy into single zone"},{key:"yes",text:"Deploy my control plane and nodes across zones 1,2,3"}],onChange:function(e,t){var a=t.key;return n("availabilityZones",a)}})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsxs)(_.a,{required:!0,children:["Cluster Auto-upgrade ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/upgrade-cluster#set-auto-upgrade-channel",children:"docs"})]}),Object(z.jsx)(T.a,{selectedKey:r.upgradeChannel,styles:{root:{marginLeft:"50px"}},options:[{key:"none",text:"Disables auto-upgrades"},{key:"patch",text:"Patch: auto-upgrade cluster to the latest supported patch version when it becomes available while keeping the minor version the same."},{key:"stable",text:"Stable: auto-upgrade cluster to the latest supported patch release on minor version N-1, where N is the latest supported minor version"},{key:"rapid",text:"Rapid: auto-upgrade cluster to the latest supported patch release on the latest supported minor version."}],onChange:function(e,t){var a=t.key;return n("upgradeChannel",a)}})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:142},styles:{root:{marginTop:10}},children:[Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(T.a,{id:"cluster-userauth-ChoiceGroup",styles:{root:{marginLeft:"50px"}},label:Object(z.jsxs)(_.a,{children:["Cluster User Authentication ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/managed-aad",children:"docs"})]}),selectedKey:r.enable_aad,onChange:function(e,t){var a=t.key;return n("enable_aad",a)},options:[{key:!1,iconProps:{iconName:"UserWarning"},text:"Kubernetes",id:"cluster-userauth-k8s"},{key:!0,iconProps:{iconName:"AADLogo"},text:"AAD Integrate",id:"cluster-userauth-aad"}]})}),Object(z.jsx)(d.a.Item,{children:r.enable_aad&&Object(z.jsxs)(d.a,{tokens:{childrenGap:10},styles:{root:{width:450,marginTop:"30px"}},children:[Object(z.jsx)(T.a,{styles:{root:{width:300}},selectedKey:r.use_alt_aad,options:[{key:!1,text:"Use the AKS subscription tenant"},{key:!0,text:"Use alt. tenant",onRenderField:function(e,t){return Object(z.jsxs)("div",{className:X,children:[t(e),Object(z.jsx)(M.a,{value:r.aad_tenant_id,onChange:function(e,t){return n("aad_tenant_id",t)},errorMessage:B(a,"aad_tenant_id"),styles:{root:{marginLeft:5}},disabled:!!e&&!r.use_alt_aad,required:!0,placeholder:"tenant id"})]})}}],onChange:function(e,t){var a=t.key;return n("use_alt_aad",a)}}),Object(z.jsx)(A.a,{checked:r.enableAzureRBAC,onChange:function(e,t){return n("enableAzureRBAC",t)},onRenderLabel:function(){return Object(z.jsxs)(u.a,{styles:{root:{color:"black"}},children:["Azure RBAC for Kubernetes Authorization ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/manage-azure-rbac",children:"docs"}),"**"]})}}),!r.enableAzureRBAC&&Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(M.a,{label:"AAD Group objectIDs that will have admin role of the cluster ',' separated",onChange:function(e,t){return n("aadgroupids",t)},value:r.aadgroupids}),r.enable_aad&&!r.aadgroupids&&Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:["You will be forbidden to do any kubernetes options unless you add a AAD Groups here, or follow ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/azure/aks/azure-ad-rbac#create-the-aks-cluster-resources-for-app-devs",children:"this"})," after the cluster is created"]})]}),Object(z.jsx)(A.a,{inputProps:{"data-testid":"cluster-localaccounts-Checkbox"},disabled:!r.enableAzureRBAC,checked:r.AksDisableLocalAccounts,onChange:function(e,t){return n("AksDisableLocalAccounts",t)},onRenderLabel:function(){return Object(z.jsxs)(u.a,{styles:{root:{color:"black"}},children:["Disable Local Kubernetes Accounts ",Object(z.jsx)(h.a,{target:"_",href:"https://docs.microsoft.com/en-us/azure/aks/managed-aad#disable-local-accounts",children:"docs"}),"**"]})}})]})})]}),Object(z.jsx)(m.a,{className:"notopmargin"}),Object(z.jsxs)(d.a.Item,{align:"start",children:[Object(z.jsx)(_.a,{required:!0,children:"Cluster API Server Security"}),Object(z.jsx)(T.a,{selectedKey:r.apisecurity,styles:{root:{marginLeft:"50px"}},options:[{key:"none",text:"Public IP with no IP restrictions"},{key:"whitelist",text:"Create allowed IP ranges (defaults to IP address of machine running the script)"},{key:"private",text:"Private Cluster (WARNING: most complex to operate)"}],onChange:function(e,t){var a=t.key;return n("apisecurity",a)}})]}),Object(z.jsxs)(d.a.Item,{align:"center",styles:{root:{maxWidth:"700px",display:"private"===r.apisecurity?"block":"none"}},children:[Object(z.jsx)(_.a,{style:{marginBottom:"0px"},children:"Private dns zone mode for private cluster."}),Object(z.jsx)(d.a,{tokens:{childrenGap:15},children:"private"===r.apisecurity&&Object(z.jsx)(T.a,{selectedKey:r.privateDNSZone,onChange:function(e,t){var a=t.key;return n("privateDNSZone",a)},options:[{key:"none",text:"None: Defaults to public DNS (AKS will not create a Private DNS Zone)"},{key:"system",disabled:!0,text:"System: AKS will create a Private DNS Zone in the Node Resource Group"},{key:"custom",disabled:!0,text:"Custom: BYO Private DNS Zone (provide ResourceId)"}]})})]})]})};function ne(e){var t,n=e.defaults,a=e.updateFn,r=e.tabValues,s=e.invalidArray,i=e.invalidTabs,l=e.urlParams,b=r.net,g=r.addons,j=r.cluster,f=r.deploy,O=!(i&&i.length>0),w=f.apiips.split(",").filter((function(e){return e.trim()})),P=Object(c.a)(Object(c.a)({},b.vnetAddressPrefix!==n.net.vnetAddressPrefix&&{vnetAddressPrefix:b.vnetAddressPrefix}),b.vnetAksSubnetAddressPrefix!==n.net.vnetAksSubnetAddressPrefix&&{vnetAksSubnetAddressPrefix:b.vnetAksSubnetAddressPrefix}),S=Object(c.a)(Object(c.a)({},b.serviceCidr!==n.net.serviceCidr&&{serviceCidr:b.serviceCidr}),b.dnsServiceIP!==n.net.dnsServiceIP&&{dnsServiceIP:b.dnsServiceIP}),C=Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({resourceName:f.clusterName},f.kubernetesVersion!==n.deploy.kubernetesVersion&&{kubernetesVersion:f.kubernetesVersion}),j.agentCount!==n.cluster.agentCount&&{agentCount:j.agentCount}),j.upgradeChannel!==n.cluster.upgradeChannel&&{upgradeChannel:j.upgradeChannel}),j.AksPaidSkuForSLA!==n.cluster.AksPaidSkuForSLA&&{AksPaidSkuForSLA:j.AksPaidSkuForSLA}),"none"===j.SystemPoolType?{JustUseSystemPool:!0}:j.SystemPoolType!==n.cluster.SystemPoolType&&{SystemPoolType:j.SystemPoolType}),j.vmSize!==n.cluster.vmSize&&{agentVMSize:j.vmSize}),j.autoscale&&{agentCountMax:j.maxCount}),"Managed"===j.osDiskType&&Object(c.a)({osDiskType:j.osDiskType},j.osDiskSizeGB>0&&{osDiskSizeGB:j.osDiskSizeGB})),"custom"===b.vnet_opt&&Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({custom_vnet:!0},S),P),b.bastion!==n.net.bastion&&{bastion:b.bastion}),b.bastion&&n.net.bastionSubnetAddressPrefix!==b.bastionSubnetAddressPrefix&&{bastionSubnetAddressPrefix:b.bastionSubnetAddressPrefix})),"byo"===b.vnet_opt&&Object(c.a)({byoAKSSubnetId:b.byoAKSSubnetId},S)),"byo"===b.vnet_opt&&"appgw"===g.ingress&&{byoAGWSubnetId:b.byoAGWSubnetId}),j.enable_aad&&Object(c.a)({enable_aad:!0},!1===j.enableAzureRBAC&&j.aad_tenant_id&&{aad_tenant_id:j.aad_tenant_id})),j.enable_aad&&j.AksDisableLocalAccounts!==n.cluster.AksDisableLocalAccounts&&{AksDisableLocalAccounts:j.AksDisableLocalAccounts}),j.enable_aad&&j.enableAzureRBAC&&Object(c.a)({enableAzureRBAC:!0},f.clusterAdminRole&&{adminprincipleid:"$(az ad signed-in-user show --query objectId --out tsv)"})),"none"!==g.registry&&Object(c.a)({registries_sku:g.registry},f.acrPushRole&&{acrPushRolePrincipalId:"$(az ad signed-in-user show --query objectId --out tsv)"})),b.afw&&Object(c.a)(Object(c.a)({azureFirewalls:!0},g.certMan&&{certManagerFW:!0}),"custom"===b.vnet_opt&&n.net.vnetFirewallSubnetAddressPrefix!==b.vnetFirewallSubnetAddressPrefix&&{vnetFirewallSubnetAddressPrefix:b.vnetFirewallSubnetAddressPrefix})),"custom"===b.vnet_opt&&b.vnetprivateend&&Object(c.a)(Object(c.a)({privateLinks:!0},"akvNew"===g.csisecret&&f.kvIPWhitelist&&w.length>0&&{kvIPWhitelist:w.map((function(e){return{value:e}}))}),n.net.privateLinkSubnetAddressPrefix!==b.privateLinkSubnetAddressPrefix&&{privateLinkSubnetAddressPrefix:b.privateLinkSubnetAddressPrefix})),"aci"===g.monitor&&Object(c.a)({omsagent:!0,retentionInDays:g.retentionInDays},g.createAksMetricAlerts!==n.addons.createAksMetricAlerts&&{createAksMetricAlerts:g.createAksMetricAlerts})),"none"!==g.networkPolicy&&{networkPolicy:g.networkPolicy}),"none"!==g.azurepolicy&&{azurepolicy:g.azurepolicy}),b.networkPlugin!==n.net.networkPlugin&&{networkPlugin:b.networkPlugin}),"custom"===b.vnet_opt&&"kubenet"===b.networkPlugin&&n.net.podCidr!==b.podCidr&&{podCidr:b.podCidr}),"yes"===j.availabilityZones&&{availabilityZones:["1","2","3"]}),"whitelist"===j.apisecurity&&f.clusterIPWhitelist&&w.length>0&&{authorizedIPRanges:w}),"private"===j.apisecurity&&{enablePrivateCluster:!0}),"none"!==g.ingress&&g.dns&&g.dnsZoneId&&{dnsZoneId:g.dnsZoneId}),"appgw"===g.ingress&&Object(c.a)(Object(c.a)({ingressApplicationGateway:!0},"custom"===b.vnet_opt&&n.net.vnetAppGatewaySubnetAddressPrefix!==b.vnetAppGatewaySubnetAddressPrefix&&{vnetAppGatewaySubnetAddressPrefix:b.vnetAppGatewaySubnetAddressPrefix}),"default"!==b.vnet_opt&&Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({appGWcount:g.appGWcount,appGWsku:g.appGWsku},"WAF_v2"===g.appGWsku&&g.appGWenableFirewall!==n.addons.appGWenableFirewall&&{appGWenableFirewall:g.appGWenableFirewall}),"WAF_v2"===g.appGWsku&&g.appGWenableFirewall&&g.appGwFirewallMode!==n.addons.appGwFirewallMode&&{appGwFirewallMode:g.appGwFirewallMode}),g.appGWautoscale&&{appGWmaxCount:g.appGWmaxCount}),g.appgw_privateIp&&{privateIpApplicationGateway:g.appgw_privateIpAddress}),g.appgwKVIntegration&&"akvNew"===g.csisecret&&{appgwKVIntegration:!0}))),"none"!==g.csisecret&&{azureKeyvaultSecretsProvider:!0}),"akvNew"===g.csisecret&&Object(c.a)({createKV:!0},f.kvCertSecretRole&&{kvOfficerRolePrincipalId:"$(az ad signed-in-user show --query objectId --out tsv)"})),I=Object(c.a)(Object(c.a)({},"none"!==g.gitops&&{gitops:g.gitops}),"custom"===b.vnet_opt&&b.vnetprivateend&&Object(c.a)({},"none"!==g.registry&&Object(c.a)(Object(c.a)({},g.acrPrivatePool!==n.addons.acrPrivatePool&&{acrPrivatePool:g.acrPrivatePool}),g.acrPrivatePool&&n.net.acrAgentPoolSubnetAddressPrefix!==b.acrAgentPoolSubnetAddressPrefix&&{acrAgentPoolSubnetAddressPrefix:b.acrAgentPoolSubnetAddressPrefix}))),N=Object(c.a)(Object(c.a)({},C),!f.disablePreviews&&I),G="aks-".concat(f.clusterName),T="agw-".concat(f.clusterName),D="# Create Resource Group \n"+"az group create -l ".concat(f.location," -n ").concat(f.rg," \n\n")+"# Deploy template with in-line parameters \n"+"az deployment group create -g ".concat(f.rg,"  ").concat("--template-uri https://github.com/Azure/Aks-Construction/releases/download/0.3.5/main.json"," --parameters")+(t=N,Object.keys(t).map((function(e){var n=t[e],a=Array.isArray(n)?JSON.stringify(JSON.stringify(n)):n;return" \\\n\t".concat(e,"=").concat(a)})).join("")),K=JSON.stringify(function(e){return Object.keys(e).filter((function(e){return"adminprincipleid"!==e&&"acrPushRolePrincipalId"!==e&&"kvOfficerRolePrincipalId"!==e})).reduce((function(t,n){return Object(c.a)(Object(c.a)({},t),{},{parameters:Object(c.a)(Object(c.a)({},t.parameters),{},Object(o.a)({},n,{value:e[n]}))})}),{$schema:"https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",contentVersion:"1.0.0.0",parameters:{}})}(N),null,2).replaceAll("\\\\\\","").replaceAll("\\\\\\",""),R="monitoring",W="monitoring",V="ingress-basic",q=("byo"===b.vnet_opt&&"appgw"===g.ingress?'#------- START Workaround to enable AGIC with BYO VNET (until supported by template)\nAPPGW_RG_ID="$(az group show -n '.concat(f.rg,' --query id -o tsv)"\nAPPGW_ID="$(az network application-gateway show -g ').concat(f.rg," -n ").concat(T,' --query id -o tsv)"\naz aks enable-addons -n ').concat(G," -g ").concat(f.rg,' -a ingress-appgw --appgw-id $APPGW_ID\nAKS_AGIC_IDENTITY_ID="$(az aks show -g ').concat(f.rg," -n ").concat(G,' --query addonProfiles.ingressApplicationGateway.identity.clientId -o tsv)"\naz role assignment create --role "Contributor" --assignee-principal-type ServicePrincipal --assignee-object-id $AKS_AGIC_IDENTITY_ID --scope $APPGW_ID\naz role assignment create --role "Reader" --assignee-principal-type ServicePrincipal --assignee-object-id $AKS_AGIC_IDENTITY_ID --scope $APPGW_RG_ID\n'):"")+("byo"===b.vnet_opt&&"appgw"===g.ingress?'\nAPPGW_IDENTITY="$(az network application-gateway show -g '.concat(f.rg," -n ").concat(T,' --query \'keys(identity.userAssignedIdentities)[0]\' -o tsv)"\naz role assignment create --role "Managed Identity Operator" --assignee-principal-type ServicePrincipal --assignee-object-id $AKS_AGIC_IDENTITY_ID --scope $APPGW_IDENTITY\n'):"")+("byo"===b.vnet_opt&&"appgw"===g.ingress?"#------- END Workaround\n  ":"")+("private"!==j.apisecurity?"\n# Get credentials for your new AKS cluster\naz aks get-credentials -g ".concat(f.rg," -n ").concat(G," "):"")+("oss"===g.monitor?"\n\n# Install kube-prometheus-stack\n".concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,'  --command "'):"","\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update\nkubectl create namespace ").concat(R,"\nhelm install ").concat(W," prometheus-community/kube-prometheus-stack --namespace ").concat(R,"\n").concat("private"===j.apisecurity?'"':"","\n"):"")+("nginx"===g.ingress?"\n\n# Create a namespace for your ingress resources\nkubectl create namespace ".concat(V,"\n\n# Add the ingress-nginx repository\nhelm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\n\n# Use Helm to deploy an NGINX ingress controller\nhelm install ").concat("nginx-ingress"," ingress-nginx/ingress-nginx \\\n  --set controller.publishService.enabled=true \\\n")+(g.ingressEveryNode?"  --set controller.kind=DaemonSet \\\n  --set controller.service.externalTrafficPolicy=Local \\\n":"")+("oss"===g.monitor?"  --set controller.metrics.enabled=true \\\n  --set controller.metrics.serviceMonitor.enabled=true \\\n  --set controller.metrics.serviceMonitor.namespace=".concat(R," \\\n  --set controller.metrics.serviceMonitor.additionalLabels.release=").concat(W," \\\n"):"")+"  --namespace ".concat(V):"")+("contour"===g.ingress?"\n\n# Install Contour Ingress Controller\n".concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,'  --command "'):"","\nkubectl apply -f https://projectcontour.io/quickstart/contour.yaml\n").concat("private"===j.apisecurity?'"':"","\n"):"")+("none"!==g.ingress&&g.dns&&g.dnsZoneId?"\n\n# Install external-dns\n# external-dns needs permissions to make changes in the Azure DNS server.\n# https://github.com/kubernetes-sigs/external-dns/blob/master/docs/tutorials/azure.md#azure-managed-service-identity-msi\n\n".concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,'  --command "'):"","\nkubectl create secret generic azure-config-file --from-file=azure.json=/dev/stdin<<EOF\n{\n  userAssignedIdentityID: $(az aks show -g ").concat(f.rg," -n ").concat(G," --query identityProfile.kubeletidentity.clientId -o tsv),\n  tenantId: $(az account show --query tenantId -o tsv),\n  useManagedIdentityExtension: true,\n  subscriptionId: ").concat(g.dnsZoneId.split("/")[2],",\n  resourceGroup: ").concat(g.dnsZoneId.split("/")[4],"\n}\nEOF\n").concat("private"===j.apisecurity?'"':"",'\n# external-dns manifest (for clusters with RBAC) replacing {{domain-filter}} and {{providers}} values\ncurl https://raw.githubusercontent.com/Azure/Aks-Construction/main/helper/config/external-dns.yml | sed -e "s|{{domain-filter}}|').concat(g.dnsZoneId.split("/")[8],'|g" -e "s|{{provider}}|').concat("privateDnsZones"===g.dnsZoneId.split("/")[7]?"azure-private-dns":"azure",'|g"  >/tmp/aks-ext-dns.yml\n').concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,' --command "kubectl apply -f ./aks-ext-dns.yml" --file  /tmp/aks-ext-dns.yml'):"kubectl apply -f /tmp/aks-ext-dns.yml","\n\n"):"")+("none"!==g.ingress&&g.certMan?"\n\n# Install cert-manager\n# https://cert-manager.io/docs/installation/\n# Cannot use 1.6.0 with AGIC https://github.com/jetstack/cert-manager/issues/4547\n\n".concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,'  --command "'):"","\nkubectl apply -f https://github.com/jetstack/cert-manager/releases/download/").concat("appgw"===g.ingress?"v1.5.3":"v1.6.0","/cert-manager.yaml\n").concat("private"===j.apisecurity?'"':"","\n\n# Wait for cert-manager to install\nsleep 30s\n\n# cert-manager ACME ClusterIssuer Configuration (client owns the domain)\n# Lets Encrypt production Issuer, using either HTTP01 for external services, or DNS01 for internal\n# https://cert-manager.io/docs/configuration/acme/\n\ncat >/tmp/aks-issuer.yml<<EOF\napiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: letsencrypt-prod\nspec:\n  acme:\n    # The ACME server URL\n    server: https://acme-v02.api.letsencrypt.org/directory\n    # Email address used for ACME registration\n    email: ").concat(g.certEmail,"\n    # Name of a secret used to store the ACME account private key\n    privateKeySecretRef:\n      name: letsencrypt-prod\n    # Enable the HTTP-01 challenge provider\n    solvers:\n#    - dns01:\n#        # Add azureDNS resolver for Private endpoints, but this need to be fixed: https://github.com/cert-manager/website/issues/662\n#        azureDNS:\n#          subscriptionID: ").concat(g.dnsZoneId.split("/")[2],"\n#          resourceGroupName: ").concat(g.dnsZoneId.split("/")[4],"\n#          hostedZoneName: ").concat(g.dnsZoneId.split("/")[8],"\n#          managedIdentity:\n#            # client id of the node pool managed identity (can not be set at the same time as resourceID)\n#            # https://github.com/tomasfreund/website/blob/ee75bf5685474c651d08750ecfe3a150de5eb586/content/en/docs/configuration/acme/dns01/azuredns.md\n#            clientID: $(az aks show -g ").concat(f.rg," -n ").concat(G," --query identityProfile.kubeletidentity.clientId -o tsv)\n    - http01:\n        ingress:\n          class: ").concat("contour"===g.ingress?"contour":"nginx"===g.ingress?"nginx":"azure/application-gateway","\nEOF\n").concat("private"===j.apisecurity?"az aks command invoke -g ".concat(f.rg," -n ").concat(G,' --command "kubectl apply -f ./aks-issuer.yml" --file  /tmp/aks-issuer.yml'):"kubectl apply -f /tmp/aks-issuer.yml","\n"):"");return Object(z.jsxs)(d.a,{tokens:{childrenGap:15},styles:L,children:[!O&&Object(z.jsx)(v.a,{messageBarType:k.a.severeWarning,children:Object(z.jsxs)(u.a,{children:["Configuration not complete, please correct the tabs with the warning symbol ",Object(z.jsxs)("b",{children:["(",i.join(" & "),")"]})," before deploying"]})}),Object(z.jsxs)(d.a,{horizontal:!0,styles:{root:{width:"100%"}},tokens:{childrenGap:50},children:[Object(z.jsxs)(d.a,{tokens:{childrenGap:10},styles:{root:{width:"400px"}},children:[Object(z.jsxs)(m.a,{children:[Object(z.jsx)("div",{style:{display:"flex",alignItems:"center"},children:Object(z.jsx)("b",{style:{marginRight:"10px"},children:"Environment Name & Location"})})," "]}),Object(z.jsx)(M.a,{label:"Cluster Name",onChange:function(e,t){return a("clusterName",t)},required:!0,errorMessage:B(s,"clusterName"),value:f.clusterName}),Object(z.jsx)(M.a,{id:"azResourceGroup",label:"Resource Group",onChange:function(e,t){return a("rg",t)},required:!0,errorMessage:B(s,"rg"),value:f.rg}),Object(z.jsx)(M.a,{label:"Kubernetes version",prefix:"Current GA Version",readOnly:!1,disabled:!1,required:!0,value:f.kubernetesVersion,onChange:function(e,t){return a("kubernetesVersion",t)}}),Object(z.jsx)(H.a,{"data-testid":"deploy-location-Dropdown",label:"Location",selectedKey:f.location,onChange:function(e,t){var n=t.key;return a("location",n)},options:[{key:"europe",text:"Europe",itemType:Q.a.Header},{key:"WestEurope",text:"West Europe"},{key:"NorthEurope",text:"North Europe"},{key:"UKSouth",text:"UK South"},{key:"UKSouth2",text:"UK South2"},{key:"UKWest",text:"UK West"},{key:"america",text:"North America",itemType:Q.a.Header},{key:"CentralUS",text:"Central US"},{key:"EastUS",text:"East US"},{key:"EastUS2",text:"East US2"},{key:"WestUS",text:"West US"},{key:"WestUS2",text:"West US2"},{key:"WestCentralUS",text:"West Central US"}],styles:{dropdown:{width:300}}})]}),Object(z.jsxs)(d.a,{tokens:{childrenGap:20},styles:{root:{width:"400px"}},children:[Object(z.jsxs)(m.a,{children:[Object(z.jsx)("div",{style:{display:"flex",alignItems:"center"},children:Object(z.jsx)("b",{style:{marginRight:"10px"},children:"Environment Access & Build Agents"})})," "]}),Object(z.jsx)(M.a,{label:"Current IP Address",prefix:"IP or Cidr , separated",errorMessage:B(s,"apiips"),onChange:function(e,t){return a("apiips",t)},value:f.apiips,required:"whitelist"===j.apisecurity}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsxs)(_.a,{children:["Grant AKS Cluster Admin Role ",Object(z.jsx)("a",{target:"_target",href:"https://docs.microsoft.com/en-gb/azure/aks/manage-azure-rbac#create-role-assignments-for-users-to-access-cluster",children:"docs"})]}),Object(z.jsx)(A.a,{disabled:!1===j.enable_aad||!1===j.enableAzureRBAC,checked:f.clusterAdminRole,onChange:function(e,t){return a("clusterAdminRole",t)},label:"Assign deployment user 'ClusterAdmin'"}),Object(z.jsx)(A.a,{disabled:"whitelist"!==j.apisecurity,onChange:function(e,t){return a("clusterIPWhitelist",t)},checked:f.clusterIPWhitelist,label:"Add current IP to AKS firewall (applicable to AKS IP ranges)"})]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Grant Azure Container Registry (ACR) Push role "}),Object(z.jsx)(A.a,{disabled:"none"===g.registry,checked:f.acrPushRole,onChange:function(e,t){return a("acrPushRole",t)},label:"Assign deployment user 'AcrPush'"})]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsxs)(_.a,{children:["Grant Key Vault Certificate and Secret Officer role ",Object(z.jsx)("a",{target:"_target",href:"https://docs.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli#azure-built-in-roles-for-key-vault-data-plane-operations",children:"docs"})]}),Object(z.jsx)(A.a,{disabled:"akvNew"!==g.csisecret,checked:f.kvCertSecretRole,onChange:function(e,t){return a("kvCertSecretRole",t)},label:"Assign deployment user Certificate and Secret Officer"}),Object(z.jsx)(A.a,{disabled:"akvNew"!==g.csisecret||!b.vnetprivateend,checked:f.kvIPWhitelist,onChange:function(e,t){return a("kvIPWhitelist",t)},label:"Add current IP to KeyVault firewall (applicable to private link)"})]})]})]}),Object(z.jsxs)(m.a,{styles:{root:{marginTop:"30px !important"}},children:[Object(z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(z.jsx)("b",{style:{marginRight:"10px"},children:"Deploy Cluster"}),Object(z.jsx)(E.a,{src:"./bicep.png"})," ",Object(z.jsx)("p",{style:{marginLeft:"10px"},children:"powered by Bicep"})]})," "]}),Object.keys(I).length>0&&Object(z.jsxs)(v.a,{messageBarType:k.a.warning,children:[Object(z.jsxs)(u.a,{children:["Your deployment contains Preview features: ",Object(z.jsx)("b",{children:Object.keys(I).join(", ")}),", Ensure you have registered for these previews, and have installed the ",Object(z.jsx)("b",{children:"'az extension add --name aks-preview'"}),"  before running the script, ",Object(z.jsx)(h.a,{target:"_pv",href:"https://github.com/Azure/AKS/blob/master/previews.md",children:"see here"}),", or disable preview features here"]}),Object(z.jsx)(p.a,{styles:{root:{marginTop:"10px"}},onText:"preview enabled",offText:"preview disabled",checked:!f.disablePreviews,onChange:function(e,t){return a("disablePreviews",!t)}})]}),Object(z.jsxs)(y.a,{children:[Object(z.jsxs)(x.a,{headerText:"Provision Environment (CLI)",children:[Object(z.jsx)(_.a,{style:{marginTop:"10px"},children:"Commands to deploy your fully operational environment"}),Object(z.jsxs)(u.a,{children:["Requires ",Object(z.jsx)(h.a,{target:"_bl",href:"https://docs.microsoft.com/cli/azure/install-azure-cli",children:"AZ CLI"}),", or, execute in the",Object(z.jsx)(h.a,{target:"_cs",href:"http://shell.azure.com/",children:"Azure Cloud Shell"}),"."]}),Object(z.jsx)(F,{deploycmd:D,testId:"deploy-deploycmd"}),""!==l.toString()&&Object(z.jsxs)(u.a,{variant:"medium",children:["Not ready to deploy? Bookmark your configuration : ",Object(z.jsx)("a",{href:"?"+l.toString(),children:"here"})]})]}),Object(z.jsx)(x.a,{headerText:"Post Configuration",children:"none"===g.gitops?[Object(z.jsx)(_.a,{style:{marginTop:"10px"},children:"Commands to install kubernetes packages into your cluster"},"post-label"),Object(z.jsxs)(u.a,{children:["Requires ",Object(z.jsx)(h.a,{target:"_bl",href:"https://helm.sh/docs/intro/install/",children:"Helm"})]},"post-text"),Object(z.jsx)(F,{deploycmd:q},"post-code")]:Object(z.jsx)(d.a,{children:Object(z.jsx)(M.a,{readOnly:!0,label:"While Gitops is in preview, run this manually",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0,rows:6,value:"az k8sconfiguration create\n        --name cluster-config\n        --cluster-name ".concat(G,"\n        --resource-group ").concat(f.rg,"\n        --operator-instance-name flux\n        --operator-namespace cluster-config\n        --enable-helm-operator\n        --operator-params='--git-readonly --git-path=cluster-config'\n        --repository-url git://github.com/khowling/aks-deploy-arm.git\n        --scope cluster\n        --helm-operator-params='--set helm.versions=v3'\n        --cluster-type managedclusters")})})}),Object(z.jsx)(x.a,{headerText:"Template Parameters File (for CI/CD)",children:Object(z.jsx)(M.a,{value:K,rows:K.split(/\r\n|\r|\n/).length+1,readOnly:!0,label:"Parameter file",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0})})]})]})}function ae(e){var t=e.tabValues,n=t.addons,a=t.deploy,r=t.net,s=t.cluster,i="aks-".concat(a.clusterName),o="\n# Build app\nexport ACRNAME=$(az acr list -g ".concat(a.rg," --query [0].name -o tsv)\naz acr build -r $ACRNAME -t openjdk-demo:0.0.1  ").concat(r.vnetprivateend?"--agent-pool private-pool":""," https://github.com/khowling/e2e-tls-java-aks.git\n\n\n\n# Create backend Certificate in KeyVault\nexport KVNAME=$(az keyvault list -g ").concat(a.rg,' --query [0].name -o tsv)\nexport COMMON_NAME=openjdk-demo\naz keyvault certificate create --vault-name $KVNAME -n $COMMON_NAME -p "$(az keyvault certificate get-default-policy | sed -e s/CN=CLIGetDefaultPolicy/CN=${COMMON_NAME}/g )"\n\n')+("appgw"===n.ingress?"\n# Wait for Cert to be issued\nsleep 1m\n\n## Create Root Cert reference in AppGW (Required for Self-Signed Cert)\naz network application-gateway root-cert create \\\n     --gateway-name $(az network application-gateway list -g ".concat(a.rg," --query [0].name -o tsv)  \\\n     --resource-group ").concat(a.rg,' \\\n     --name $COMMON_NAME \\\n     --keyvault-secret $(az keyvault secret list-versions --vault-name $KVNAME -n $COMMON_NAME --query "[?attributes.enabled].id" -o tsv)\n'):"")+"\n# Install\nexport APPNAME=openjdk-demo\n".concat("private"===s.apisecurity?"az aks command invoke -g ".concat(a.rg," -n ").concat(i,'  --command "'):"","\nhelm upgrade --install $APPNAME https://github.com/khowling/e2e-tls-java-aks/blob/main/openjdk-demo-3.1.0.tgz?raw=true  --set ingressType=").concat(n.ingress,",letsEncrypt.issuer=letsencrypt-prod,image.repository=${ACRNAME}.azurecr.io/openjdk-demo,image.tag=0.0.1,csisecrets.vaultname=${KVNAME},csisecrets.tenantId=$(az account show --query tenantId -o tsv),csisecrets.clientId=$(az aks show -g ").concat(a.rg," -n ").concat(i," --query addonProfiles.azureKeyvaultSecretsProvider.identity.clientId -o tsv),dnsname=${APPNAME}.").concat(n.dnsZoneId.split("/")[8],"\n").concat("private"===s.apisecurity?'"':"","\n");return Object(z.jsx)(d.a,{tokens:{childrenGap:15},styles:L,children:Object(z.jsxs)(y.a,{children:[Object(z.jsx)(x.a,{headerText:"Secure Java",children:Object(z.jsxs)(d.a,{tokens:{childrenGap:15},styles:L,children:[Object(z.jsxs)(m.a,{styles:{root:{marginTop:"30px !important"}},children:[Object(z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(z.jsx)("b",{style:{marginRight:"10px"},children:"Java Spring Boot Hello World"}),Object(z.jsx)(E.a,{height:"80px",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Spring_Framework_Logo_2018.svg/245px-Spring_Framework_Logo_2018.svg.png"})]})," "]}),Object(z.jsxs)(d.a.Item,{children:[Object(z.jsx)(_.a,{children:"Simple Java Spring boot application, that uses KeyVault to generate Certs to expose Tomcat TLS endpoint, and public Ingress TLS issued by cert-manager"}),Object(z.jsx)(v.a,{messageBarType:k.a.error,children:"Please ensure your deployment meets all the requirements below in order to run the demo app successfully"}),Object(z.jsx)(_.a,{children:"Sample App Requires"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:"none"!==n.registry,label:"(Addons tab) Container Registry, for application container repository"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},disabled:!r.vnetprivateend,checked:n.acrPrivatePool,label:"(Addons tab) Container Registry Private Pool, for container build task (required for private link only)"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:a.kvCertSecretRole,label:"(Deploy tab) Grant Key Vault Certificate and Secret Officer"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:"akvNew"===n.csisecret,label:"(Addons tab) CSI Secrets, for tomcat TLS certificates"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:"none"!==n.ingress,label:"(Addons Tab) Ingress, for securely exposing app"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:n.dns,label:"(Addons Tab) external-dns, for application hostname resolution"}),Object(z.jsx)(A.a,{styles:{root:{marginLeft:"50px"}},checked:n.certMan,label:"(Addons Tab) cert-manager, to generate the frontend CA signed Cert"})]}),Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(F,{deploycmd:o})})]})}),Object(z.jsxs)(x.a,{headerText:".NET Microservices",children:[Object(z.jsxs)(m.a,{styles:{root:{marginTop:"30px !important"}},children:[Object(z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(z.jsx)("b",{style:{marginRight:"10px"},children:"TBC"}),Object(z.jsx)(E.a,{height:"80px",src:"https://img.stackshare.io/service/11331/asp.net-core.png"})]})," "]}),Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(_.a,{children:"."})}),Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(M.a,{value:"",rows:25,readOnly:!0,styles:{root:{fontFamily:'Monaco, Menlo, Consolas, "Droid Sans Mono", Inconsolata, "Courier New", monospace'},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0})})]}),Object(z.jsxs)(x.a,{headerText:"Full Stack Typescript",children:[Object(z.jsxs)(m.a,{styles:{root:{marginTop:"30px !important"}},children:[Object(z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(z.jsx)("b",{style:{marginRight:"10px"},children:"TBC"}),Object(z.jsx)(E.a,{height:"80px",src:"https://sdtimes.com/wp-content/uploads/2020/06/ts-logo-256.png"})]})," "]}),Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(_.a,{children:"."})}),Object(z.jsx)(d.a.Item,{children:Object(z.jsx)(M.a,{value:"",rows:25,readOnly:!0,styles:{root:{fontFamily:'Monaco, Menlo, Consolas, "Droid Sans Mono", Inconsolata, "Courier New", monospace'},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0})})]})]})})}var re=n(189);function se(e){var t=e.entScale,n=e.setEntScale;e.featureFlag;return Object(z.jsxs)(d.a,{horizontal:!0,tokens:{childrenGap:10},children:[Object(z.jsx)("img",{src:"aks.svg",alt:"Kubernetes Service",style:{width:"6%",height:"auto"}}),Object(z.jsxs)(d.a,{tokens:{padding:10},children:[Object(z.jsx)(u.a,{variant:"xLarge",children:"AKS Deploy helper"}),Object(z.jsxs)(u.a,{children:["Provide the requirements of your AKS deployment to generate the assets to create a full operational environment, incorporating best-practices guidance. For documentation, and CI/CD samples - please refer to our ",Object(z.jsx)("a",{href:"https://github.com/Azure/Aks-Construction",target:"_blank",rel:"noopener noreferrer",children:"GitHub Repository"})]})]}),Object(z.jsx)(d.a.Item,{tokens:{padding:10},children:Object(z.jsx)(p.a,{label:Object(z.jsxs)(u.a,{nowrap:!0,children:["Enterprise Scale"," ",Object(z.jsx)(b.a,{content:"use if you are following Enterprise Scale",children:Object(z.jsx)(g.a,{iconName:"Info","aria-label":"Info tooltip"})})]}),onText:"Yes",offText:"No",checked:t,disabled:!1,onChange:function(e,t){return n(t)}})})]})}function ie(e){var t=e.config;console.log("PortalNav: ".concat(JSON.stringify(Object.keys(t))));var n,r,s=t.tabLabels,i=t.defaults,p=t.entScaleOps,b=t.defaultOps,f=Object(a.useState)(Object.keys(s)[0]),v=Object(l.a)(f,2),k=v[0],O=v[1];n="PortalNav",r=s[k],Object(a.useEffect)((function(){var e=new Date,t="".concat(n,".").concat(r);return de.startTrackPage(t),function(){console.log("exit screen ".concat(r," ").concat((new Date-e)/1e3)),de.stopTrackPage(t,{"Component Name":n,Navigation:r},{mounttime:(new Date-e)/1e3})}}),[n,r]);var w=Object(a.useState)(new URLSearchParams(window.location.search)),A=Object(l.a)(w,2),P=A[0],S=A[1],C=Object(a.useState)((function(){return Object.keys(i).reduce((function(e,t){return Object(c.a)(Object(c.a)({},e),{},Object(o.a)({},t,[]))}),{})})),I=Object(l.a)(C,2),N=I[0],_=I[1],T=P.has("feature"),D=Object(a.useState)((function(){return P.has("entScale")})),K=Object(l.a)(D,2),E=K[0],M=K[1],R=E?p:b,W=Object(a.useState)((function(){return{values:R.reduce((function(e,t){return Object(c.a)(Object(c.a)({},e),{},Object(o.a)({},t.key,P.has(t.key)?P.get(t.key):t.cards.find((function(e){return e.default})).key))}),{}),entScale:E}})),B=Object(l.a)(W,2),L=B[0],F=B[1],V=Object(a.useState)((function(){var e="az-k8s-".concat((Math.floor(9e5*Math.random())+1e5).toString(36)),t=Object.keys(L.values).reduce((function(e,t){return H(e,R,t,L.values[t])}),i),n=Object(c.a)(Object(c.a)({},t),{},{deploy:Object(c.a)(Object(c.a)({},t.deploy),{},{clusterName:e,rg:"".concat(e,"-rg")})});return Object.keys(n).reduce((function(e,t){return Object(c.a)(Object(c.a)({},e),{},Object(o.a)({},t,Object.keys(n[t]).reduce((function(e,a){var r="".concat(t,".").concat(a),s=n[t][a];if(P.has(r)){var i=P.get(r);s="true"===i||"false"!==i&&(isNaN(i)?i:parseInt(i))}return Object(c.a)(Object(c.a)({},e),{},Object(o.a)({},a,s))}),{})))}),{})})),U=Object(l.a)(V,2),Z=U[0],$=U[1];function H(e,t,n,a){var r=t.find((function(e){return e.key===n})).cards.find((function(e){return e.key===a})).values;return console.log("updateTabValues: sectionKey=".concat(n," cardKey=").concat(a,", setting tabs ").concat(JSON.stringify(Object.keys(r)))),Object.keys(r).reduce((function(t,n){return Object(c.a)(Object(c.a)({},t),{},Object(o.a)({},n,Object(c.a)(Object(c.a)({},t[n]),Object.keys(r[n]).reduce((function(t,a){var s=r[n][a],i=Array.isArray(s)&&s.length>0&&"object"===typeof s[0]&&s[0].hasOwnProperty("set")?s.reduce((function(t,n){return void 0===t?n.page&&n.field?e[n.page][n.field]===n.value?n.set:void 0:n.set:t}),void 0):s;return Object(c.a)(Object(c.a)({},t),{},Object(o.a)({},a,i))}),{}))))}),e)}function Y(e,t,n){P.set("".concat(e,".").concat(t),n),$((function(a){return Object(c.a)(Object(c.a)({},a),{},Object(o.a)({},e,Object(c.a)(Object(c.a)({},a[e]),{},Object(o.a)({},t,n))))}))}function Q(e,t,n,a){var r=function(e,t){return N[e].find((function(e){return e.field===t}))}(e,t);!n&&r?_((function(n){return Object(c.a)(Object(c.a)({},n),{},Object(o.a)({},e,n[e].filter((function(e){return e.field!==t}))))})):n&&!r&&_((function(n){return Object(c.a)(Object(c.a)({},n),{},Object(o.a)({},e,n[e].concat({field:t,message:a})))}))}Object(a.useEffect)((function(){fetch("https://api.ipify.org?format=json").then((function(e){return e.json()})).then((function(e){console.log("useEffect Get IP"),$((function(t){return Object(c.a)(Object(c.a)({},t),{},{deploy:Object(c.a)(Object(c.a)({},t.deploy),{},{apiips:"".concat(e.ip,"/32")})})}))})).catch((function(e){return console.error("Problem fetching my IP",e)}))}),[]);var X=Z.deploy,re=Z.cluster,ie=Z.net,oe=Z.addons;function ce(e,t,n){return Object(z.jsxs)("span",{children:[N[e].length>0&&Object(z.jsx)(g.a,{iconName:"Warning12",style:{color:"red"}}),n(t)]})}return console.log("PortalNav: Evaluating configruation warnings..."),Q("cluster","osDiskType","Ephemeral"===re.osDiskType&&!ee.find((function(e){return e.key===re.vmSize})).eph,Object(z.jsxs)(u.a,{children:[Object(z.jsx)("b",{children:"ERROR"}),": The selected VM cache is not large enough to support Ephemeral. Select 'Managed' or a VM with a larger cache"]})),Q("cluster","aad_tenant_id",re.enable_aad&&re.use_alt_aad&&36!==re.aad_tenant_id.length,Object(z.jsx)(u.a,{children:"Enter Valid Directory ID"})),Q("addons","registry",ie.vnetprivateend&&"Premium"!==oe.registry&&"none"!==oe.registry,Object(z.jsxs)(u.a,{children:[Object(z.jsx)("b",{children:"ERROR"}),": Premium tier is required for Private Link, either select Premium, or disable Private Link"]})),Q("addons","dnsZoneId",oe.dns&&!oe.dnsZoneId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/(dnszones|privateDnsZones)/[^/ ]+$"),Object(z.jsx)(u.a,{children:"Enter valid Azure Public or Private DNS Zone resourceId"})),Q("addons","certEmail",oe.certMan&&!oe.certEmail.match("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$"),Object(z.jsx)(u.a,{children:"Enter valid email for certificate generation"})),Q("addons","kvId","akvExist"===oe.csisecret&&!oe.kvId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.KeyVault/vaults/[^/ ]+$"),Object(z.jsx)(u.a,{children:"Enter valid Azure KeyVault resourceId"})),Q("addons","appgw_privateIpAddress","appgw"===oe.ingress&&oe.appgw_privateIp&&!oe.appgw_privateIpAddress.match("^(?:[0-9]{1,3}.){3}[0-9]{1,3}$"),Object(z.jsx)(u.a,{children:"Enter valid IP address"})),Q("addons","appgwKVIntegration","appgw"===oe.ingress&&oe.appgwKVIntegration&&"akvNew"!==oe.csisecret,Object(z.jsxs)(u.a,{children:[Object(z.jsx)("b",{children:"ERROR"}),": KeyVault integration requires the 'CSI Secrets' 'Yes, Provision a new KeyVault' option to be selected"]})),Q("addons","ingress",ie.afw&&"none"!==oe.ingress&&"appgw"!==oe.ingress,Object(z.jsxs)(u.a,{children:[Object(z.jsx)("b",{children:"WARNING"}),": Using a in-cluster ingress option with Azure Firewall will require additional asymmetric routing configuration post-deployment, please see ",Object(z.jsx)(h.a,{target:"_target",href:"https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic#add-a-dnat-rule-to-azure-firewall",children:"Add a DNAT rule to Azure Firewall"})]})),Q("net","byoAKSSubnetId","byo"===ie.vnet_opt&&!ie.byoAKSSubnetId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/virtualNetworks/[^/ ]+/subnets/[^/ ]+$"),Object(z.jsx)(u.a,{children:"Enter a valid Subnet Id where AKS nodes will be installed"})),Q("net","byoAGWSubnetId","byo"===ie.vnet_opt&&"appgw"===oe.ingress&&!ie.byoAGWSubnetId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/virtualNetworks/[^/ ]+/subnets/[^/ ]+$"),Object(z.jsx)(u.a,{children:"Enter a valid Subnet Id where Application Gateway is installed"})),Q("net","vnet_opt","default"===ie.vnet_opt&&(ie.afw||ie.vnetprivateend),Object(z.jsx)(u.a,{children:"Cannot use default networking of you select Firewall or Private Link"})),Q("net","afw",ie.afw&&"custom"!==ie.vnet_opt,"byo"===ie.vnet_opt?Object(z.jsx)(u.a,{children:"Please de-select, when using Bring your own VNET, configure a firewall as part of your own VNET setup, (in a subnet or peered network)"}):Object(z.jsxs)(u.a,{children:[Object(z.jsx)("b",{children:"WARNING"}),': This template can only deploy Azure Firewall in single VNET with Custom Networking"']})),Q("deploy","apiips","whitelist"===re.apisecurity&&X.apiips.length<7,Object(z.jsx)(u.a,{children:"Enter an IP/CIDR, or disable API Security in 'Cluster Details' tab"})),Q("deploy","clusterName",!X.clusterName||null===X.clusterName.match(/^[a-z0-9][_\-a-z0-9]+[a-z0-9]$/i)||X.clusterName.length>19,Object(z.jsx)(u.a,{children:"Enter valid cluster name"})),Object(z.jsx)("main",{id:"mainContent",className:"wrapper",children:Object(z.jsxs)(j.a,{children:[Object(z.jsx)(se,{entScale:E,setEntScale:M,featureFlag:T}),Object(z.jsxs)(d.a,{verticalFill:!0,styles:{root:{width:"960px",margin:"0 auto",color:"grey"}},children:[Object(z.jsx)(G,{sections:R,selectedValues:L.values,updateSelected:function(e,t){S((function(n){return L.entScale!==E&&(console.log("User changed entScale switch, and selected a new card, need to unselect old cards"),b.forEach((function(e){n.delete(e.key)})),p.forEach((function(e){n.delete(e.key)}))),E?n.set("entScale",1):n.delete("entScale"),n.set(e,t),n})),console.log("updateSelected: sectionKey=".concat(e," cardKey=").concat(t)),F({entScale:E,values:Object(c.a)(Object(c.a)({},L.entScale===E&&L.values),{},Object(o.a)({},e,t))}),$((function(n){return H(n,R,e,t)}))}}),Object(z.jsxs)(m.a,{styles:{root:{marginTop:"55px !important",marginBottom:"5px"}},children:[Object(z.jsx)("b",{children:"Deploy"})," (optionally use 'Details' tabs for additional configuration)"]}),Object(z.jsxs)(y.a,{selectedKey:k,onLinkClick:function(e){O(e.props.itemKey)},focusZoneProps:{"data-testid":"portalnav-Pivot"},children:[Object(z.jsx)(x.a,{headerText:s.deploy,itemKey:"deploy",onRenderItemLink:function(e,t){return ce("deploy",e,t)},children:Object(z.jsx)(ne,{defaults:i,tabValues:Z,updateFn:function(e,t){return Y("deploy",e,t)},invalidArray:N.deploy,invalidTabs:Object.keys(N).filter((function(e){return N[e].length>0})).map((function(e){return"'".concat(s[e],"'")})),urlParams:P})}),Object(z.jsx)(x.a,{headerText:s.cluster,itemKey:"cluster",onRenderItemLink:function(e,t){return ce("cluster",e,t)},children:Object(z.jsx)(te,{tabValues:Z,updateFn:function(e,t){return Y("cluster",e,t)},invalidArray:N.cluster})}),Object(z.jsx)(x.a,{headerText:s.addons,itemKey:"addons",onRenderItemLink:function(e,t){return ce("addons",e,t)},children:Object(z.jsx)(J,{tabValues:Z,updateFn:function(e,t){return Y("addons",e,t)},invalidArray:N.addons})}),Object(z.jsx)(x.a,{headerText:s.net,itemKey:"net",onRenderItemLink:function(e,t){return ce("net",e,t)},children:Object(z.jsx)(q,{tabValues:Z,featureFlag:T,updateFn:function(e,t){return Y("net",e,t)},invalidArray:N.net})}),Object(z.jsx)(x.a,{headerText:s.app,itemKey:"app",onRenderItemLink:function(e,t){return ce("app",e,t)},children:Object(z.jsx)(ae,{tabValues:Z,featureFlag:T,updateFn:function(e,t){return Y("app",e,t)},invalidArray:N.app})})]})]})]})})}function oe(){return Object(z.jsx)(ue.Consumer,{children:function(e){return Object(z.jsx)(ie,{config:e})}})}Object(re.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=n(188),le=n(98),de=new ce.a({config:{instrumentationKey:"db40ec1e-0181-45dd-8fb8-525e07839cfa"}});de.loadAppInsights();var ue=r.a.createContext();i.a.render(Object(z.jsx)(ue.Provider,{value:le,children:Object(z.jsx)(oe,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},98:function(e){e.exports=JSON.parse('{"tabLabels":{"deploy":"Deploy","cluster":"Cluster Details","addons":"Addon Details","net":"Networking Details","app":"Sample Apps"},"defaults":{"deploy":{"kubernetesVersion":"1.20.9","location":"WestEurope","apiips":"","demoapp":false,"disablePreviews":false,"acrPushRole":true,"kvCertSecretRole":true,"kvIPWhitelist":false,"clusterAdminRole":true,"clusterIPWhitelist":true},"cluster":{"AksPaidSkuForSLA":false,"apisecurity":"none","privateDNSZone":"none","autoscale":false,"upgradeChannel":"none","SystemPoolType":"Cost-Optimised","agentCount":3,"maxCount":20,"vmSize":"Standard_DS3_v2","osDiskSizeGB":0,"osDiskType":"Ephemeral","enable_aad":true,"AksDisableLocalAccounts":false,"use_alt_aad":false,"aad_tenant_id":"","enableAzureRBAC":true,"aadgroupids":"","availabilityZones":"no"},"addons":{"networkPolicy":"none","azurepolicy":"none","ingress":"none","ingressEveryNode":false,"appgw_privateIp":false,"appgw_privateIpAddress":"","appGWautoscale":true,"appGWcount":0,"appGWmaxCount":10,"appGWsku":"WAF_v2","appGWenableFirewall":true,"appGwFirewallMode":"Prevention","appgwKVIntegration":false,"certMan":false,"certEmail":"","dns":false,"dnsZoneId":"","registry":"none","acrPrivatePool":false,"podid":false,"podscale":false,"monitor":"none","retentionInDays":30,"createAksMetricAlerts":true,"csisecret":"none","kvId":"","gitops":"none"},"net":{"networkPlugin":"azure","afw":false,"bastion":false,"vnetprivateend":false,"vnet_opt":"default","byoAKSSubnetId":"","byoAGWSubnetId":"","vnetAddressPrefix":"10.240.0.0/16","vnetAksSubnetAddressPrefix":"10.240.0.0/22","vnetAppGatewaySubnetAddressPrefix":"10.240.4.0/26","acrAgentPoolSubnetAddressPrefix":"10.240.4.64/26","bastionSubnetAddressPrefix":"10.240.4.128/26","privateLinkSubnetAddressPrefix":"10.240.4.192/26","vnetFirewallSubnetAddressPrefix":"10.240.50.0/24","podCidr":"10.240.100.0/24","serviceCidr":"172.10.0.0/16","dnsServiceIP":"172.10.0.10"},"app":{"javatls":false}},"defaultOps":[{"key":"ops","sectionTitle":"Operations Principles","cards":[{"key":"none","title":"Simplest bare-bones cluster","description":{"title":"Just Kubernetes please, I will make decisions later","bulets":[]},"icon":"Manufacturing","values":{"cluster":{"SystemPoolType":"none","autoscale":false,"upgradeChannel":"none"},"addons":{"registry":"none","ingress":"none","monitor":"none"}}},{"key":"oss","title":"I prefer control & community open source solutions","description":{"title":"Use proven, open source projects for my Kubernetes operational environment, and self-manage my clusters upgrades and scaling","bulets":[{"description":"Manual Upgrades"},{"description":"Manual Scaling"},{"description":"Contour Ingress","linksrc":"https://projectcontour.io/"},{"description":"Prometheus/Grafana Monitoring","linksrc":"https://coreos.com/operators/prometheus/docs/latest/user-guides/getting-started.html"},{"description":"DockerHub container registry"}]},"icon":"DeveloperTools","values":{"cluster":{"SystemPoolType":"Cost-Optimised","autoscale":false,"upgradeChannel":"none"},"addons":{"registry":"none","ingress":"contour","monitor":"oss"}}},{"key":"managed","default":true,"title":"I want a managed environment","description":{"title":"I\'d like my cluster to be auto-managed by Azure for upgrades and scaling, and use Azure provided managed addons to create an full environment with the minimum of operational requirements","bulets":[{"description":"Cluster auto-scaler","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Cluster auto-upgrades","linksrc":"https://docs.microsoft.com/en-us/azure/aks/upgrade-cluster#set-auto-upgrade-channel"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"}]},"icon":"Touch","values":{"cluster":{"SystemPoolType":"Cost-Optimised","autoscale":true,"upgradeChannel":"stable"},"addons":{"registry":[{"page":"net","field":"vnetprivateend","value":true,"set":"Premium"},{"set":"Basic"}],"ingress":"appgw","appgwKVIntegration":[{"page":"addons","field":"csisecret","value":"akvNew","set":true},{"set":false}],"monitor":"aci"}}}]},{"key":"secure","sectionTitle":"Security Principles","cards":[{"key":"low","title":"Simple cluster with no additional access limitations","description":{"title":"Simplest option for experimenting with kubernetes, or clusters with no sensitive data","bulets":[]},"icon":"Unlock","values":{"deploy":{"kvIPWhitelist":false},"cluster":{"enable_aad":false,"AksDisableLocalAccounts":false,"apisecurity":"none"},"addons":{"networkPolicy":"none","registry":[{"page":"addons","field":"registry","value":"Standard","set":"Basic"},{"page":"addons","field":"registry","value":"Premium","set":"Basic"},{"set":"none"}],"azurepolicy":"none","appgwKVIntegration":false,"csisecret":"none"},"net":{"vnet_opt":"default","vnetprivateend":false,"afw":false,"bastion":false}}},{"key":"normal","default":true,"title":"Cluster with additional security controls","description":{"title":"Good option for implementing recommended minimum security controls for regular environments","bulets":[{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"AUDIT Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Authorized IP address ranges","linksrc":"https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges"}]},"icon":"Lock12","values":{"deploy":{"kvIPWhitelist":false},"cluster":{"enable_aad":true,"AksDisableLocalAccounts":true,"apisecurity":"whitelist"},"addons":{"networkPolicy":"azure","registry":[{"page":"addons","field":"registry","value":"Basic","set":"Premium"},{"page":"addons","field":"registry","value":"Standard","set":"Premium"},{"page":"addons","field":"registry","value":"Premium","set":"Premium"},{"set":"none"}],"acrPrivatePool":false,"azurepolicy":"audit","appgwKVIntegration":[{"page":"addons","field":"ingress","value":"appgw","set":true},{"set":false}],"csisecret":"akvNew"},"net":{"vnet_opt":"custom","vnetprivateend":false,"afw":false,"bastion":false}}},{"key":"private","title":"Private cluster with isolating networking controls","description":{"title":"Best option for high-secure, regulated environments or sensitive data requirements.","titleWarning":{"description":"WARNING: most complex environment option to operate","MessageBarType":5},"bulets":[{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"ENFORCE Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Private Cluster","linksrc":"https://docs.microsoft.com/en-us/azure/aks/private-clusters"},{"description":"Restrict dependencies with Private Link","linksrc":"https://docs.microsoft.com/en-us/azure/private-link/private-link-overview"},{"description":"Restrict egress with Azure Firewall","linksrc":"https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic#restrict-egress-traffic-using-azure-firewall"},{"description":"Store Kubernetes Secrets in Azure KeyVault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"icon":"ProtectionCenterLogo32","values":{"deploy":{"kvIPWhitelist":true},"cluster":{"enable_aad":true,"AksDisableLocalAccounts":true,"apisecurity":"private"},"addons":{"networkPolicy":"azure","registry":[{"page":"addons","field":"registry","value":"Basic","set":"Premium"},{"page":"addons","field":"registry","value":"Standard","set":"Premium"},{"page":"addons","field":"registry","value":"Premium","set":"Premium"},{"set":"none"}],"acrPrivatePool":true,"appgwKVIntegration":[{"page":"addons","field":"ingress","value":"appgw","set":true},{"set":false}],"azurepolicy":"deny","csisecret":"akvNew"},"net":{"vnet_opt":"custom","vnetprivateend":true,"afw":true,"bastion":true}}}]}],"entScaleOps":[{"key":"entscale","sectionTitle":"Enterprise Scale Management Group","sectionWarning":"Before you continue, Ensure you have deployed the Enterprise Scale reference implementation","cards":[{"key":"sandbox","default":true,"title":"Sandbox","description":{"title":"For dev/test applications, and other experimental purposes. Sandbox Subscriptions will not typically be allowed connectivity to Production and Policy will prevent the connectivity to on-premises Resources.","bulets":[{"description":"Cluster auto-scaler (2-4 nodes)","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry (public)"},{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"Audit Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"}]},"imageSrc":"./Entscale-sandbox.png","author":{"name":"Gordon Byers","initials":"GB","status":"Updated March, 2021"},"values":{"cluster":{"enable_aad":true,"AksDisableLocalAccounts":false,"apisecurity":"none","autoscale":true,"agentCount":2,"maxCount":4,"upgradeChannel":"none"},"addons":{"networkPolicy":"none","registry":"Basic","azurepolicy":"audit","ingress":"none","appgwKVIntegration":false,"monitor":"aci","csisecret":"none"},"net":{"vnetprivateend":false,"vnet_opt":"default","afw":false}}},{"key":"corp","default":true,"title":"Corp (Connected existing Hub)","description":{"title":"For Corp connected applications that require connectivity to on-premises, to other landing zones or to the internet via shared services provided in a network hub","titleWarning":{"description":"Requires existing Subnet, preconfigured with firewall egress","MessageBarType":5},"bulets":[{"description":"Cluster auto-scaler","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry (with Private Link)"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"},{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"Audit Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Private Cluster","linksrc":"https://docs.microsoft.com/en-us/azure/aks/private-clusters"},{"description":"Restrict dependencies with Private Link","linksrc":"https://docs.microsoft.com/en-us/azure/private-link/private-link-overview"},{"description":"Store Kubernetes Secrets in Azure KeyVault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"imageSrc":"./Entscale-corp.png","author":{"name":"Gordon Byers","initials":"GB","status":"Updated March, 2021"},"values":{"cluster":{"enable_aad":true,"AksDisableLocalAccounts":true,"apisecurity":"private","autoscale":true,"upgradeChannel":"none"},"addons":{"networkPolicy":"azure","registry":"Premium","azurepolicy":"audit","ingress":"appgw","monitor":"aci","csisecret":"akvNew","appgwKVIntegration":true},"net":{"vnetprivateend":true,"vnet_opt":"byo","afw":false}}},{"key":"online","default":true,"title":"Online (Internet facing)","description":{"title":"For Online applications that will be internet-facing, where hybrid connectivity is not required","bulets":[{"description":"Cluster auto-scaler","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry (with Private Link)"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"},{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"Audit Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Private Cluster","linksrc":"https://docs.microsoft.com/en-us/azure/aks/private-clusters"},{"description":"Restrict dependencies with Private Link","linksrc":"https://docs.microsoft.com/en-us/azure/private-link/private-link-overview"},{"description":"Restrict egress with Azure firewall (provisioned & configured separately)","linksrc":"https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic#restrict-egress-traffic-using-azure-firewall"},{"description":"Store Kubernetes Secrets in Azure KeyVault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"imageSrc":"./Entscale-online.png","author":{"name":"Gordon Byers","initials":"GB","status":"Updated March, 2021"},"values":{"cluster":{"enable_aad":true,"AksDisableLocalAccounts":true,"apisecurity":"private","autoscale":true,"upgradeChannel":"none"},"addons":{"networkPolicy":"azure","registry":"Premium","azurepolicy":"audit","ingress":"appgw","monitor":"aci","csisecret":"akvNew","appgwKVIntegration":true},"net":{"vnetprivateend":true,"vnet_opt":"custom","afw":true}}}]}]}')}},[[121,1,2]]]);
//# sourceMappingURL=main.e13d8b47.chunk.js.map